---
title: "Change resources"
---

## In preparation


```{r}
remotes::install_github("sizespectrum/mizerExperimental")
library(mizerExperimental)
remotes::install_github("sizespectrum/mizerMR")
library(mizerMR)
remotes::install_github("sizespectrum/mizerHowTo")
library(mizerHowTo)
library(tidyverse)
source("helper_functions.R")
```

function forcing plankton from climate model 
```{r}

plankton_forcing <- function(params, t, ...) {
  w_cut_off <- 10
  pkt <- 10^(other_params(params)$n_pp_array[t + params@other_params$other$t_idx,])/params@dw_full # converting to density
  pkt[which(as.numeric(names(pkt)) >= w_cut_off)] <- 0
  
  return(pkt)  
}


sim<-readRDS("sim_scen2.rds")
params<-sim@params
params <- setResource(params, resource_dynamics = "plankton_forcing")

```


Set the scenarios

```{r}

# Create parameter objects
# 
# params_IPSL_picontrol <- params
# params_IPSL_ssp1rcp26 <- params
# params_IPSL_ssp5rcp85 <- params
# # Attach temperature
# other_params(params_IPSL_picontrol)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_PIcontrol.RDS")
# other_params(params_IPSL_ssp1rcp26)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_CCscenario_126.RDS")
# other_params(params_IPSL_ssp5rcp85)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_CCscenario_585.RDS")
# # Attach plankton
# other_params(params_IPSL_picontrol)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_PIcontrol.RDS")
# other_params(params_IPSL_ssp1rcp26)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_CCscenario_126.RDS")
# other_params(params_IPSL_ssp5rcp85)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_CCscenario_585.RDS")
# 
# 

#sim <- project(params_IPSL_ssp1rcp26, effort = effort)
```

_ use the resource_dynamics function 


# Set up new resource forcing "function" - just changes to different time slot in the n_pp_array array


Set the scenarios

```{r}
# Create parameter objects
# params_IPSL_picontrol <- params
# params_IPSL_ssp1rcp26 <- params
# params_IPSL_ssp5rcp85 <- params
# Attach temperature
# other_params(params_IPSL_picontrol)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_PIcontrol.RDS")
# other_params(params_IPSL_ssp1rcp26)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_CCscenario_126.RDS")
# other_params(params_IPSL_ssp5rcp85)$ocean_temp <- readRDS("processed/IPSL_ocean_temp_array_CCscenario_585.RDS")
# # Attach plankton
# other_params(params_IPSL_picontrol)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_PIcontrol.RDS")
# other_params(params_IPSL_ssp1rcp26)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_CCscenario_126.RDS")
# other_params(params_IPSL_ssp5rcp85)$n_pp_array <- readRDS("processed/IPSL_n_pp_array_CCscenario_585.RDS")
# 

simple example showing effect of two different states - e.g. change in resource slopes and intercepts on steady states?


NOTES: 
3. Change Resources 
-Plankton over time - resource_dynamics 

Project the above scenario holding effort constant 

Can directly use outputs of earth system models for projections (GFDL inputs - FishMIP), to easily show you what functions to work we will use 2 stylised scenarios that you can adapt and explore for your own model scenarios.

If you wish to participate in FishMIP, we  provide inputs of ocean physical & bc variables to modellers.

trend - X% decline per year, lambda and X% 

(Add noise ?)

Exercise - try creating  running your own scenarios - with and without fishing -how do changes in resource affect the catches abs biomass compared to the baseline (no change in resources scenario) . How does biomass change with & without fishing under the scenarios 




