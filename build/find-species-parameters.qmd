---
title: "Finding species parameters"
---

Here you will learn how to find appropriate values for the species parameters needed to set up your own mizer model.

## Selecting model species

How do we decide which species to include in the model? There are many ways to approach it and no clearly set rules. Of course you want to include species that you are interested in, but then also perhaps some other important species in the ecosystem. Mizer actually has a powerful framework that allows you to explicitly model only your focus species and represent the rest of the ecosystem with some 'background' species. The sizes and abundances of these 'background' species are assumed to follow the power law, so that the total community biomass approximately represents the Sheldon spectrum. This is only mentioned here for your information, as we will not go into these details during this week.

If you have your own ecosystem that you want to model during this week, then you also have your own list of species. Ideally you may want to have somewhere around 4 to 20 species, as this allows for interesting but also tractable dynamics (although tracking processes in all 20 species might be quite challenging). For the Curonian Lagoon model we selected key ecosystem fish species that are commonly observed in scientific monitoring surveys, and which live and reproduce in the ecosystem (as compared to several migratory species, which can be abundant briefly but do not have a big role in the ecosystem). The list of species and their general feeding habits or trophic group are listed below. We include scientific and model name, the latter representing a short name that we can conveniently use and display in plots.

| Scientific name                        | Model name | Trophic group |
|----------------------------------------|------------|---------------|
| Pungitius pungitius, Alburnus alburnus | smallfish  | planktivore   |
| Gymnocephalus cernua                   | ruffe      | benthivore    |
| Abramis brama, Blicca bjoerkna         | breams     | benthivore    |
| Rutillus rutillus                      | roach      | benthivore    |
| Vimba vimba                            | vimba      | benthivore    |
| Carassius carassius                    | carassius  | benthivore    |
| Perca fluviatilis                      | perch      | omnivore      |
| Sander lucioperca                      | pikeperch  | predator      |
| Lota lota                              | burbot     | predator      |
| Esox lucius, Aspius aspius             | predators  | predator      |

## Essential parameters

At this point it might be useful to go back and rewatch the second half of Ken Andersen's introductory lecture, which explains species parameters used in mizer. It is great how mizer can start building a model with only very few species parameters! For many parameters, if values are not supplied by the user, mizer can fill them with default values using size-based theory or species averages. However, there are several parameters that the user must provide for the model species:

1.  Asymptotic body size `w_inf`

2.  Von-Bertalanffy growth rate `k_vb` or species maximum intake rate coefficient `h` Even if you provide `h` values, you might still want to include `k_vb` in your species parameter file, because it can be used to plot modelled versus expected growth rates.

3.  Predator-prey mass ratio `beta`

4.  A vector of species biomasses to be provided in the `biomass_observed` column. This vector represents average species biomasses in your model system. The units of the area or volume over which these biomasses were observed depend on your choice, mizer does not care about it (see section [Units in mizer](https://sizespectrum.org/mizer/reference/setParams.html#setting-search-volume) in this reference page).

    **Make a note box: How to get observed biomasses?**

    To calibrate the reproduction level, mizer needs some information about species abundance or biomasses. People often use average observed biomases of species (in the volume or area, depending on the choice of units). Remember, these are just average values, not time series of observations. Observed biomasses could be derived from scientific surveys, underwater surveys or similar sources. Sometimes we can simply use relative biomasses, which scale the relative abundances of species in the model. One can also use average catches if they also known average fishing mortality **(ASTA comment to delete - but we know that mizer mortality and stock assessment mortality is NOT the same and could be quite different?).**

    Below is a summary of key parameters

![](/images/parameterSketch.png)

> ### Von Bertalanffy Growth Function
>
> The growth curve of a fish is commonly reported as a von Bertalanffy growth curve. The von Bertalanffy curve describes the length of a fish as a function of two parameters; the asymptotic length $L_\infty$ and the von Bertalanffy growth coefficient $K$ (`k_vb` in mizer): $$ L_{(t)} = L_\infty (1-e^{-Kt}) $$ where $t$ is the age. $L_\infty$ represents the asymptotic length and $1/K$ is approximately the age at maturation. Mizer, however, uses two other parameters, $W_\infty$ (`w_inf` in Mizer) and $h$, where $W_\infty$ represents the asymptotic weight and $h$ the size-scaled maximum consumption rate. Fortunately, the two sets of parameters are related, and one can derive $h$ and $W_\infty$ from von Bertalanffy $K$ and $L_\infty$.

> The parameter $h$ represents the maximum consumption rate of a fish, scaled by size. The value of $h$ varies between 4 -- 400, with a geometric mean around 22 g$^{-0.25}$/year across all fish species (Andersen 2019, chap. 2 and 11). A more precise estimate ccould be obtained from von Bertalanffy $K$ and $L_\infty$ as: $h \approx 4.75 K\cdot L_\infty^{0.75}$ (with $K$ given in 1/years and $L_\infty$ in cm).

## Other species parameters

There are many other parameters that are used to describe species properties, but mizer has default ways to calculate them based on the size theory expectations. You can read about the theory in various publications or in the excellent Ken H Andersen book ["Fish Ecology, Evolution, and Exploitation" (2019)](https://ken.haste.dk/home/publications).

The parameter with default values are:

6.  Maturation body size `w_mat` Usually you would want to set them up yourself from life-history data, but if no data is available mizer will use 0.25 \* `w_inf` There is one more reproduction investment parameter `m` which determines the scaling of the investment into reproduction for mature individuals. By default `m` = 1 which means that the rate at which energy is invested into reproduction scales linearly with the size. This default can be changed to another value if different scaling is preferred (e.g. in case you might want to explore [hyper-allometric reproduction investment options](https://www.pnas.org/doi/abs/10.1073/pnas.2100695118)).

7.  Species feeding or satiation level at larval stage `f0` If no value is provided mizer assumes 0.6.

8.  Species critical feeding level, or feeding level at which energy intake is equal to meatoblic (maintenance) expenditure `fc`. If no value is provided mizer assumes 0.2.

9.  Parameter defining the width of the predation kernel `sigma` If no value is provided mizer will use a default value of 2 (which is actually a very wide kernel).

10. Species search volume constant `gamma` and its body size scaling exponent `q` If no values are provided the `gamma` and `q` are set so that when prey abundance is described by the power law with the exponent `lambda`, food search rate will lead to the feeding level `f0`.

11. Species maximum intake rate constant `h` and its body size scaling exponent `n` If no value is provided the coefficient `h` is set so as to achieve Von-Bertalanffy growth rates (given the feeding level `f0`). In multi-species models the exponent `n` is by default set to 2/3.

12. Species metabolic rate constants `ks` and its body size scaling exponent `p` If no values are provided the coefficient `ks` is set so that at maturation size metabolic expenditure requires `fc` (critical feeding) level of maximum intake. The exponent `p` by default is set at 0.7. You can also include species activity coefficient `k` which scales linearly with body size (exponent of 1). By default this value is set to 0 and most mizer models do not include it.

13. Species food assimilation efficiency `alpha` If no value is provided mizer assumes 0.6

14. Species minimum body size in the model `w_min` If no value is provided mizer assumes 0.001

15. Species external (also called background or baseline) size-independent mortality rate constant `z0` This parameter determines the background mortality that affects all species size classes in the same way (it is a flat rate across sizes). If no values are provided mizer assumes that species with small maximum body sizes have much higher baseline mortality rate (e.g. a species with `w_inf` = 35 g will have `z0` = 0.18, a species with `w_inf` = 150g will have `z0` = 0.11 and a species with `w_inf` = 14kg will have `z0` = 0.025.

16. Species reproduction parameters `R_max` and `erepro`. They are derived based on a steady state and observed biomases, but their adjustment is an important part of model parameterisation. We will talk about them in later tutorials.

17. Species length-weight conversion coefficients `a` and `b` These coefficients are only needed if maximum or maturation body size are provided in length.

18. You can also modify availability of the resource to each of your species, as we have learned during week 1. This is set by the parameter `interaction_resource` and this value is set to 1 by default.

There are more parameters defining the selectivity and catchability of species by different fishing gears, and we will learn about them in the next tutorial. You can also modify the shape of predation kernel. See [here](https://sizespectrum.org/mizer/reference/species_params.html) for further details. All of the default values can be changed by the user. Advanced users can even override different mizer functions that calculate parameters. If you feel you need more advanced reading you can explore it [here](https://sizespectrum.org/mizer/reference/setParams.html)

> ### Length-weight regression
>
> The asymptotic length and weight are related as: $$W_\infty = a \cdot L_\infty^b$$ Species-specific conversion coefficients $a$ and $b$ are available on FishBase. If no data is avaialbe for your specific species, reasonable general values are: $a = 0.01\ \mathrm{g/cm}^{-3}$ and $b = 3$.

::: {.callout-important collapse="false"}
Note that species parameters are used when setting up a new model object with newMultispeciesParams() and calculating species and size specific rates. If parameters are changed later, it have no effect because the default for the other parameters will not be recalculated. If you do want to change parameters, you need to setup a new params object.
:::

Let's explore species parameter file for the North Sea model supplied together with the mizer package. First, we load the mizerExperimental() library

```{r}
#| message: false
remotes::install_github("sizespectrum/mizerExperimental")
library(mizerExperimental)
library(tidyverse)
```

```{r}
species_params(NS_params)

```

You can see big differences in species `beta` values and big differences in `z0` values which depend on species maximum size.

You can also see that, unlike with the idealised trait-based model, the maximum intake, search rate and metabolism exponents are not set at $3/4$ . There is a lot of debate about the correct values for these exponents. Some schools of thought argue that energy intake should scale with individual's surface area (exponent of $2/3$ ) whereas energy expenditure should scale with body volume (exponent of $1$ ). Others suggest that food intake and metabolism exponents should both scale with $3/4$ . There are no clear rules and these exponents in reality are likely to vary across species. But in most cases mizer users just go with defaults.

## Exercise 1: collecting species parameters from FishBase

Now our goal is to set up species parameter data frame. You may have this information from literature or your own research. But in this exercise we will use FishBase, where many modellers get their species parameters. In this exercise please open the **species_params_exercise.csv** file, go to FishBase, look up our model species and find their essential parameters (for as many species as you like).

**Important!** Make sure you check all the different sources of information that FishBase has. Scroll all the way down to "More information" section and explore Length-weight, Fecundity, Age/size, Food items, Diet and especially Growth sections. Then select the best parameters for the species, enter them in the csv file. You can fill only those parameters that you think are essential, e.g. you can fill both `k_vb` and `h` or just one of them.

Note, you will not be able find values for `h` or predation kernel parameters of `beta` and `sigma` on FishBase. So use knowledge you have gained so far to make an approximate guess. Also pay attention to the species trophic groups. Species that are benthivores may not feed on other fish, but on small benthic invertebrates. You can check that in the Diet and Food items section in FishBase. For benthivorous and planktivorous species `beta` values will be much larger (i.e. prey is relatively smaller) than for predators. You can inspect the North Sea species parameter file or make some estimations yourself. For example, a 500g bream is feeding on small invertebrates, like amphipods. If we use the generic length-weight conversion then a 5mm (0.5cm) amphipod will weigh 0.01\*0.5\^3 = 0.00125 grams. This will give you a general idea about the approximate `beta` values for benthivorous fish.

**ASTA's comment to delete - we need to give the participants the file /experiment/species_params_exercise.csv which they will have to fill**

## Species interaction matrix

The next thing we will need to provide to mizer is species interaction matrix. This matrix can include three different aspects (or a combination of all of them):

1.  **Spatial and temporal overlap of species in a large ecosystem**. This way the interaction matrix is set based on e.g. species occurrences in various fisheries surveys or observations and reflect the frequency of how often same species are found in same surveys. This is how species interactions are set up in the example [North Sea model](https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2664.12238), which comes with mizer installation. Let's check it (we will round the values to two decimal points). The North Sea interaction matrix file is called NS_interaction and comes with mizer installation

    ```{r}

    round(NS_interaction,2)


    ```

2.  **Species diet preferences** **or trophic groups**. Sometimes we know that certain species do not eat other species. For example, some species are strictly bentivorous or herbivorous and they never eat any other fish, not even their larvae. In other cases we might have good evidence for specific diet preferences, although ideally such evidence should come from food selection experiments and these are very rare and maybe too specific to certain conditions. It is important to know that diet contents do not necessarily reflect preferences, but realised feeding. A species might prefer to eat bananas, but if nothing else is available it will eat other fish. The species interaction matrix, if reflecting diet preferences, should reflect preferred diets, not realised diets.

3.  **Species predator avoidance behaviour or vulnerability**. Some species may be less available to other species because they are good at hiding, have spikes, or live in large schools which reduces their vulnerability to predation compared to solitary species. This could also be included in the species interaction matrix, but in the prey column.

    For our Curonian lagoon example model we used existing ecological knowledge and set up species interaction matrix as follows:

    **ASTA comment - Need to display this matrix in a nicer way**

```{r}
curon_interaction <-  read_csv("experiment/curonian_interaction.csv")
curon_interaction

```

Here, the interaction matrix has two main components:

1.  We assume that only up to 70% of prey biomass is available to a predator at one given time step. This means that if the predator numbers are huge and they all eat a certain prey (which fits into their predation kernel), in one time step of the model predators can consume only 70% of prey biomass. In the next step they can consume 70% of the remaining biomass, but of course prey will grow and reproduce a bit during that time as well. With this assumption predators cannot eat all prey of a suitable size at once. This is why there most values are set to 0.7
2.  We assume that strictly benthivorous fish species (breams, roach, vimba, carassius) cannot eat any other fish. This is based on the available knowledge about diets and feeding habits.
